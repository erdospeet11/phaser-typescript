(()=>{"use strict";const t=Phaser;var e,n=(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}),o=function(t){function e(){return t.call(this,{key:"MenuScene"})||this}return n(e,t),e.prototype.create=function(){var t=this;this.add.rectangle(0,0,this.cameras.main.width,this.cameras.main.height,0,.7).setOrigin(0,0),this.add.text(this.cameras.main.centerX,100,"PAUSED",{fontSize:"32px",color:"#ffffff",fontFamily:"monospace"}).setOrigin(.5);var e=this.add.rectangle(this.cameras.main.centerX,200,200,50,4868682).setInteractive();this.add.text(this.cameras.main.centerX,200,"Resume Game",{fontSize:"20px",color:"#ffffff",fontFamily:"monospace"}).setOrigin(.5),e.on("pointerover",(function(){return e.setFillStyle(6974058)})),e.on("pointerout",(function(){return e.setFillStyle(4868682)})),e.on("pointerdown",(function(){return t.resumeGame()})),this.input.keyboard.on("keydown-ESC",(function(){return t.resumeGame()}));var n=this.add.rectangle(this.cameras.main.centerX,300,200,50,4868682).setInteractive();this.add.text(this.cameras.main.centerX,300,"Settings",{fontSize:"20px",color:"#ffffff",fontFamily:"monospace"}).setOrigin(.5),n.on("pointerover",(function(){return n.setFillStyle(6974058)})),n.on("pointerout",(function(){return n.setFillStyle(4868682)})),n.on("pointerdown",(function(){return t.settings()}));var o=this.add.rectangle(this.cameras.main.centerX,400,200,50,4868682).setInteractive();this.add.text(this.cameras.main.centerX,400,"Generator",{fontSize:"20px",color:"#ffffff",fontFamily:"monospace"}).setOrigin(.5),o.on("pointerover",(function(){return o.setFillStyle(6974058)})),o.on("pointerout",(function(){return o.setFillStyle(4868682)})),o.on("pointerdown",(function(){return t.generatorGame()}))},e.prototype.resumeGame=function(){this.scene.resume("GameScene"),this.scene.stop()},e.prototype.generatorGame=function(){this.scene.launch("DungeonGeneratorScene"),this.scene.stop()},e.prototype.settings=function(){console.log("Settings")},e}(Phaser.Scene),i=function(){function t(t,e,n){this.scene=t,this.owner=e,this.cooldown=n,this.isOnCooldown=!1}return t.prototype.startCooldown=function(){var t=this;this.isOnCooldown=!0,this.scene.time.delayedCall(1e3*this.cooldown,(function(){t.isOnCooldown=!1}))},t.prototype.canUse=function(){return!this.isOnCooldown},t}(),r=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),s=function(t){function e(e,n){var o=t.call(this,e,n,2)||this;return o.damage=20,o.speed=300,o}return r(e,t),e.prototype.use=function(){if(this.canUse()){var t=this.scene.physics.add.sprite(this.owner.x,this.owner.y,"fireball"),e=this.scene.input.activePointer,n=Phaser.Math.Angle.Between(this.owner.x,this.owner.y,e.worldX,e.worldY);t.setVelocity(Math.cos(n)*this.speed,Math.sin(n)*this.speed),this.startCooldown()}},e}(i),a=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),h=function(t){function e(e,n,o){var i=t.call(this,e,n,o,"player")||this;i.isPoweredUp=!1,i.baseAttack=10,i.health=100,i.maxHealth=100,i.attack=i.baseAttack,i.speed=.5,i.money=0,i.coins=0,e.physics.add.existing(i),e.add.existing(i),e.physics.add.existing(i);var r=i.body;return r.setCollideWorldBounds(!0),r.setSize(16,16),r.enable=!0,r.immovable=!1,i.setCollideWorldBounds(!0),r.setSize(16,16),i.cursors=e.input.keyboard.createCursorKeys(),e.input.keyboard.addKeys("W,A,S,D"),i.abilities=[new s(e,i)],i}return a(e,t),e.prototype.update=function(){var t=this;this.scene.input.keyboard.keys[Phaser.Input.Keyboard.KeyCodes.A].isDown&&(this.x-=this.speed,this.setFlipX(!0)),this.scene.input.keyboard.keys[Phaser.Input.Keyboard.KeyCodes.D].isDown&&(this.x+=this.speed,this.setFlipX(!1)),this.scene.input.keyboard.keys[Phaser.Input.Keyboard.KeyCodes.W].isDown&&(this.y-=this.speed),this.scene.input.keyboard.keys[Phaser.Input.Keyboard.KeyCodes.S].isDown&&(this.y+=this.speed),this.scene.input.keyboard.on("keydown-Q",(function(){t.useAbility(0)}))},e.prototype.damage=function(t){this.health=Math.max(0,this.health-t),this.health<=0&&this.handleDeath()},e.prototype.getHealth=function(){return this.health},e.prototype.getMaxHealth=function(){return this.maxHealth},e.prototype.handleDeath=function(){},e.prototype.addCoins=function(t){this.coins+=t,this.emit("coinsChanged",this.coins)},e.prototype.getCoins=function(){return this.coins},e.prototype.addPowerup=function(t){var e=this;this.powerupTimer&&this.powerupTimer.destroy(),this.isPoweredUp=!0,this.attack=2*this.baseAttack,this.setTint(16711680),this.powerupTimer=this.scene.time.delayedCall(1e3*t,(function(){e.endPowerup()})),this.emit("powerupStarted",t)},e.prototype.endPowerup=function(){this.isPoweredUp=!1,this.attack=this.baseAttack,this.clearTint(),this.emit("powerupEnded")},e.prototype.isPowered=function(){return this.isPoweredUp},e.prototype.heal=function(t){this.health=Math.min(this.health+t,this.maxHealth),this.emit("healthChanged",this.health)},e.prototype.getAttack=function(){return this.attack},e.prototype.getSpeed=function(){return this.speed},e.prototype.getMoney=function(){return this.money},e.prototype.useAbility=function(t){t>=0&&t<this.abilities.length&&this.abilities[t].use()},e}(Phaser.Physics.Arcade.Sprite),c=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),p=function(t){function e(e,n,o){var i=t.call(this,e,n,o,"enemy")||this;e.physics.add.existing(i);var r=i.body;return r.setCollideWorldBounds(!0),r.setSize(16,16),i.health=50,i.maxHealth=50,i.attack=5,i.speed=.25,i.healthBar=e.add.graphics(),e.add.existing(i),i.updateHealthBar(),i}return c(e,t),e.prototype.damage=function(t){this.health=Math.max(0,this.health-t),this.updateHealthBar(),this.health<=0&&this.handleDeath()},e.prototype.updateHealthBar=function(){this.healthBar.clear(),this.healthBar.fillStyle(16711680),this.healthBar.fillRect(this.x-25,this.y-20,50,5);var t=this.health/this.maxHealth*50;this.healthBar.fillStyle(65280),this.healthBar.fillRect(this.x-25,this.y-20,t,5)},e.prototype.handleDeath=function(){this.healthBar.destroy(),this.emit("death"),this.destroy()},e.prototype.update=function(t){var e=t.x-this.x,n=t.y-this.y,o=Math.sqrt(e*e+n*n);if(o>0){var i=e/o,r=n/o;this.body.setVelocity(i*this.speed*100,r*this.speed*100),this.setFlipX(i<0)}this.updateHealthBar()},e.prototype.getHealth=function(){return this.health},e.prototype.getAttack=function(){return this.attack},e}(Phaser.GameObjects.Sprite),l=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),u=function(t){function e(e,n,o,i){var r=t.call(this,e,n,o,i)||this;return r.value=0,e.add.existing(r),e.physics.add.existing(r),r.body.setBounce(.2),e.tweens.add({targets:r,y:r.y-5,duration:1500,yoyo:!0,repeat:-1}),r}return l(e,t),e}(Phaser.GameObjects.Sprite),y=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),f=function(t){function e(e,n,o){var i=t.call(this,e,n,o,"health-pickup")||this;return i.value=20,i}return y(e,t),e.prototype.collect=function(t){t.heal(this.value),this.destroy()},e}(u),d=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),m=function(t){function e(){return t.call(this,{key:"MainGameScene"})||this}return d(e,t),e.prototype.preload=function(){this.load.image("player","assets/player.png"),this.load.image("tile","assets/tile.png"),this.load.image("enemy","assets/enemy.png"),this.load.image("health-pickup","assets/health_pickup.png"),this.load.image("wall","assets/wall.png")},e.prototype.create=function(){var t=this;this.tileSprite=this.add.tileSprite(0,0,this.cameras.main.width,this.cameras.main.height,"tile"),this.tileSprite.setOrigin(0,0),this.walls=this.physics.add.staticGroup();for(var e=0;e<20;e++)[this.walls.create(16*e,0,"wall"),this.walls.create(16*e,304,"wall"),this.walls.create(0,16*e,"wall"),this.walls.create(304,16*e,"wall")].forEach((function(t){t.refreshBody()}));this.player=new h(this,400,300),this.player.setScale(1),this.cursors=this.input.keyboard.createCursorKeys(),this.input.keyboard.addKeys("W,A,S,D"),this.setupCamera(),this.enemy=new p(this,600,300),this.enemy=new p(this,500,300),this.enemy=new p(this,400,300),this.healthPickup=new f(this,300,300),this.physics.add.overlap(this.player,this.healthPickup,this.handlePickupCollision,void 0,this),this.physics.add.collider(this.enemy,this.walls),this.physics.add.collider(this.player,this.walls),this.input.keyboard.on("keydown-ESC",(function(){t.scene.pause(),t.scene.launch("MenuScene")})),this.setupDebug()},e.prototype.handlePickupCollision=function(t,e){e.collect(t)},e.prototype.setupDebug=function(){this.physics.world.createDebugGraphic(),this.physics.world.debugGraphic.setAlpha(.75),this.physics.world.defaults.debugShowBody=!0,this.physics.world.defaults.debugShowStaticBody=!0,this.physics.world.defaults.debugShowVelocity=!0,this.physics.world.defaults.bodyDebugColor=16711935},e.prototype.setupCamera=function(){this.cameras.main.startFollow(this.player),this.cameras.main.setBounds(0,0,1600,1200),this.cameras.main.setZoom(2),this.cameras.main.setLerp(.1,.1)},e.prototype.update=function(){this.player.update(),this.enemy.update(this.player)},e}(Phaser.Scene),w=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),g=function(t){function e(){var e=t.call(this,{key:"DungeonGeneratorScene"})||this;return e.grid=[],e.GRID_SIZE=30,e.CELL_SIZE=32,e}return w(e,t),e.prototype.generateRooms=function(t){for(var e=0;e<t;e++)for(var n=Phaser.Math.Between(4,8),o=Phaser.Math.Between(4,8),i=Phaser.Math.Between(1,this.GRID_SIZE-n-1),r=Phaser.Math.Between(1,this.GRID_SIZE-o-1),s=-1;s<=o;s++)for(var a=-1;a<=n;a++)this.grid[r+s][i+a]=-1===a||a===n||-1===s||s===o?1:0},e.prototype.create=function(){var t=this;this.cameras.main.setBackgroundColor("#000000"),this.mainCamera=this.cameras.main,this.mainCamera.setZoom(.75),this.input.on("wheel",(function(e,n,o,i){var r=-.001*i,s=Phaser.Math.Clamp(t.mainCamera.zoom+r,.25,2);t.mainCamera.setZoom(s)})),this.grid=Array(this.GRID_SIZE).fill(0).map((function(){return Array(t.GRID_SIZE).fill(0)})),this.generateRooms(1);var e=this.GRID_SIZE*this.CELL_SIZE,n=this.GRID_SIZE*this.CELL_SIZE,o=(this.cameras.main.width-e)/2,i=(this.cameras.main.height-n)/2,r=this.add.graphics();r.lineStyle(1,3355443);for(var s=0;s<this.GRID_SIZE;s++)for(var a=0;a<this.GRID_SIZE;a++){r.strokeRect(o+a*this.CELL_SIZE,i+s*this.CELL_SIZE,this.CELL_SIZE,this.CELL_SIZE),1===this.grid[s][a]&&(r.fillStyle(6710886),r.fillRect(o+a*this.CELL_SIZE,i+s*this.CELL_SIZE,this.CELL_SIZE,this.CELL_SIZE));var h=1===this.grid[s][a]?"ðŸ§±":"0";this.add.text(o+a*this.CELL_SIZE+this.CELL_SIZE/2,i+s*this.CELL_SIZE+this.CELL_SIZE/2,h,{color:"#ffffff",fontSize:"16px",fontFamily:"monospace"}).setOrigin(.5,.5)}},e.prototype.update=function(){this.input.mousePointer.isDown&&(this.mainCamera.scrollX-=(this.input.mousePointer.x-this.input.mousePointer.prevPosition.x)/this.mainCamera.zoom,this.mainCamera.scrollY-=(this.input.mousePointer.y-this.input.mousePointer.prevPosition.y)/this.mainCamera.zoom)},e.prototype.regenerateDungeon=function(){this.create()},e.prototype.preload=function(){this.load.image("player","assets/player.png"),this.load.image("player","/assets/player.png")},e}(Phaser.Scene),_={type:t.AUTO,width:800,height:550,physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!0,debugShowBody:!0,debugShowStaticBody:!0,debugShowVelocity:!0}},scene:[m,g,o],scale:{mode:t.Scale.FIT,autoCenter:t.Scale.CENTER_BOTH},pixelArt:!0,antialias:!1};new Phaser.Game(_)})();